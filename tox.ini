[tox]
envlist = py{38,39,310,311,312}, lint, format, type, docs
skip_missing_interpreters = true

[testenv]
deps =
    -rrequirements.txt
    pytest
    pytest-cov
setenv =
    PYTHONPATH = {toxinidir}
commands =
    python -c "import bash_script_maker; import syntax_highlighter; print('Import test passed')"
    python -c "import tkinter; print('Tkinter available')"
    python -c "from bash_script_maker import BashScriptMaker; print('BashScriptMaker class available')"
    python -c "from syntax_highlighter import BashScriptEditor; print('BashScriptEditor class available')"
    python -m pytest tests/ -v

[testenv:lint]
deps = flake8
commands = flake8 bash_script_maker.py syntax_highlighter.py

[testenv:format]
deps = black
commands = black --check --diff bash_script_maker.py syntax_highlighter.py

[testenv:type]
deps = mypy
commands = mypy bash_script_maker.py syntax_highlighter.py --ignore-missing-imports --no-error-summary

[testenv:docs]
deps = pdoc3
commands =
    mkdir -p docs
    pdoc3 --html --output-dir docs bash_script_maker syntax_highlighter

[testenv:build]
deps =
    build
    twine
commands =
    python -m build
    python -m twine check dist/*

[testenv:clean]
deps =
commands =
    rm -rf build dist *.egg-info docs __pycache__ .pytest_cache .tox .coverage

[flake8]
max-line-length = 127
max-complexity = 10
ignore = E203, E501, W503
exclude =
    .git,
    __pycache__,
    build,
    dist,
    *.egg-info,
    .tox,
    docs
